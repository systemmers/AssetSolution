{% extends "base.html" %}

{% block title %}운영 관리 - 자산관리 시스템{% endblock %}

{% block page_header %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="h2 mb-0 text-gray-800">
        <i class="fas fa-cogs me-2 text-primary"></i>자산 운영 관리
    </h1>
</div>
{% endblock %}

{% block content %}
<!-- 운영 관리 대시보드 카드 -->
<div class="row mb-4">
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card shadow-sm border-start-primary h-100">
            <div class="card-body p-4">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <div class="text-muted small fw-semibold text-uppercase">현재 대여 중</div>
                        <div class="h3 mb-0 fw-bold text-gray-800">28</div>
                    </div>
                    <div class="flex-shrink-0">
                        <i class="fas fa-exchange-alt fa-2x text-primary"></i>
                    </div>
                </div>
            </div>
            <div class="card-footer bg-transparent border-0">
                <a href="{{ url_for('operations.loan_index') }}?status=대여중" class="text-decoration-none">
                    <small class="text-primary fw-medium">
                        자세히 보기 <i class="fas fa-arrow-right ms-1"></i>
                    </small>
                </a>
            </div>
        </div>
    </div>
    
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card shadow-sm border-start-success h-100">
            <div class="card-body p-4">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <div class="text-muted small fw-semibold text-uppercase">오늘 반납 예정</div>
                        <div class="h3 mb-0 fw-bold text-gray-800">3</div>
                    </div>
                    <div class="flex-shrink-0">
                        <i class="fas fa-clock fa-2x text-success"></i>
                    </div>
                </div>
            </div>
            <div class="card-footer bg-transparent border-0">
                <a href="{{ url_for('operations.loan_index') }}?due=today" class="text-decoration-none">
                    <small class="text-success fw-medium">
                        자세히 보기 <i class="fas fa-arrow-right ms-1"></i>
                    </small>
                </a>
            </div>
        </div>
    </div>
    
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card shadow-sm border-start-warning h-100">
            <div class="card-body p-4">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <div class="text-muted small fw-semibold text-uppercase">반납 지연</div>
                        <div class="h3 mb-0 fw-bold text-gray-800">5</div>
                    </div>
                    <div class="flex-shrink-0">
                        <i class="fas fa-exclamation-triangle fa-2x text-warning"></i>
                    </div>
                </div>
            </div>
            <div class="card-footer bg-transparent border-0">
                <a href="{{ url_for('operations.loan_index') }}?status=overdue" class="text-decoration-none">
                    <small class="text-warning fw-medium">
                        자세히 보기 <i class="fas fa-arrow-right ms-1"></i>
                    </small>
                </a>
            </div>
        </div>
    </div>
    
    <div class="col-xl-3 col-md-6 mb-4">
        <div class="card shadow-sm border-start-danger h-100">
            <div class="card-body p-4">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <div class="text-muted small fw-semibold text-uppercase">폐기 승인 대기</div>
                        <div class="h3 mb-0 fw-bold text-gray-800">2</div>
                    </div>
                    <div class="flex-shrink-0">
                        <i class="fas fa-trash-alt fa-2x text-danger"></i>
                    </div>
                </div>
            </div>
            <div class="card-footer bg-transparent border-0">
                <a href="{{ url_for('operations.disposal_index') }}?status=pending" class="text-decoration-none">
                    <small class="text-danger fw-medium">
                        자세히 보기 <i class="fas fa-arrow-right ms-1"></i>
                    </small>
                </a>
            </div>
        </div>
    </div>
</div>

<!-- 자산 운영 기능 카드 -->
<div class="row">
    <!-- 자산 대여 관리 카드 -->
    <div class="col-lg-4 mb-4">
        <div class="card shadow-sm border-0 h-100">
            <div class="card-header bg-light border-bottom py-3">
                <div class="d-flex justify-content-between align-items-center">
                    <h6 class="mb-0 fw-semibold text-primary">
                        <i class="fas fa-handshake me-2"></i>자산 대여 관리
                    </h6>
                    <a href="{{ url_for('operations.loan_index') }}" class="btn btn-primary btn-sm">
                        <i class="fas fa-list fa-sm"></i> 전체 보기
                    </a>
                </div>
            </div>
            <div class="card-body d-flex flex-column p-4">
                <p class="text-muted">자산의 대여 신청, 승인, 사용 현황 관리 및 모니터링</p>
                <div class="list-group mb-3">
                    <a href="{{ url_for('operations.loan_index') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        대여 현황 <i class="fas fa-chevron-right"></i>
                    </a>
                    <a href="{{ url_for('operations.loan_form') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        대여 신청/등록 <i class="fas fa-chevron-right"></i>
                    </a>
                </div>
                <div class="mt-auto text-center">
                    <a href="{{ url_for('operations.loan_form') }}" class="btn btn-outline-primary">
                        <i class="fas fa-plus me-1"></i> 새 대여 등록
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 자산 반납 관리 카드 -->
    <div class="col-lg-4 mb-4">
        <div class="card shadow-sm border-0 h-100">
            <div class="card-header bg-light border-bottom py-3">
                <div class="d-flex justify-content-between align-items-center">
                    <h6 class="mb-0 fw-semibold text-success">
                        <i class="fas fa-undo me-2"></i>자산 반납 관리
                    </h6>
                    <a href="{{ url_for('operations.return_history') }}" class="btn btn-success btn-sm">
                        <i class="fas fa-list fa-sm"></i> 전체 보기
                    </a>
                </div>
            </div>
            <div class="card-body d-flex flex-column p-4">
                <p class="text-muted">자산의 반납 처리, 승인 워크플로우 및 이력 관리</p>
                <div class="list-group mb-3">
                    <a href="{{ url_for('operations.return_approval_workflow') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        <span><i class="fas fa-tasks me-2 text-primary"></i>승인 워크플로우</span> <i class="fas fa-chevron-right"></i>
                    </a>
                    <a href="{{ url_for('operations.return_status_tracking') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        <span><i class="fas fa-chart-line me-2 text-info"></i>상태 추적</span> <i class="fas fa-chevron-right"></i>
                    </a>
                    <a href="{{ url_for('operations.return_notifications') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        <span><i class="fas fa-bell me-2 text-warning"></i>알림 관리</span> <i class="fas fa-chevron-right"></i>
                    </a>
                    <a href="{{ url_for('operations.return_history') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        반납 이력 <i class="fas fa-chevron-right"></i>
                    </a>
                    <a href="{{ url_for('operations.return_form') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        반납 처리 <i class="fas fa-chevron-right"></i>
                    </a>
                </div>
                <div class="mt-auto text-center">
                    <a href="{{ url_for('operations.return_form') }}" class="btn btn-outline-success">
                        <i class="fas fa-undo me-1"></i> 반납 처리
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 자산 폐기 관리 카드 -->
    <div class="col-lg-4 mb-4">
        <div class="card shadow-sm border-0 h-100">
            <div class="card-header bg-light border-bottom py-3">
                <div class="d-flex justify-content-between align-items-center">
                    <h6 class="mb-0 fw-semibold text-danger">
                        <i class="fas fa-trash-alt me-2"></i>자산 폐기 관리
                    </h6>
                    <a href="{{ url_for('operations.disposal_index') }}" class="btn btn-danger btn-sm">
                        <i class="fas fa-list fa-sm"></i> 전체 보기
                    </a>
                </div>
            </div>
            <div class="card-body d-flex flex-column p-4">
                <p class="text-muted">자산의 폐기 신청, 승인, 처리 관리</p>
                <div class="list-group mb-3">
                    <a href="{{ url_for('operations.disposal_index') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        폐기 현황 <i class="fas fa-chevron-right"></i>
                    </a>
                    <a href="{{ url_for('operations.disposal_form') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        폐기 신청/등록 <i class="fas fa-chevron-right"></i>
                    </a>
                </div>
                <div class="mt-auto text-center">
                    <a href="{{ url_for('operations.disposal_form') }}" class="btn btn-outline-danger">
                        <i class="fas fa-trash-alt me-1"></i> 폐기 신청
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- 자산 지급 관리 카드 -->
    <div class="col-lg-4 mb-4">
        <div class="card shadow-sm border-0 h-100">
            <div class="card-header bg-light border-bottom py-3">
                <div class="d-flex justify-content-between align-items-center">
                    <h6 class="mb-0 fw-semibold text-warning">
                        <i class="fas fa-hand-holding me-2"></i>자산 지급 관리
                    </h6>
                    <a href="{{ url_for('operations.allocation_management') }}" class="btn btn-warning btn-sm">
                        <i class="fas fa-list fa-sm"></i> 전체 보기
                    </a>
                </div>
            </div>
            <div class="card-body d-flex flex-column p-4">
                <p class="text-muted">자산의 지급 신청, 승인, 배포 관리</p>
                <div class="list-group mb-3">
                    <a href="{{ url_for('operations.allocation_management') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        지급 현황 <i class="fas fa-chevron-right"></i>
                    </a>
                    <a href="#" onclick="openAllocationModal()" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        지급 신청/등록 <i class="fas fa-chevron-right"></i>
                    </a>
                </div>
                <div class="mt-auto text-center">
                    <button class="btn btn-outline-warning" onclick="openAllocationModal()">
                        <i class="fas fa-hand-holding me-1"></i> 지급 신청
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 자산 업그레이드 관리 카드 -->
    <div class="col-lg-4 mb-4">
        <div class="card shadow-sm border-0 h-100">
            <div class="card-header bg-light border-bottom py-3">
                <div class="d-flex justify-content-between align-items-center">
                    <h6 class="mb-0 fw-semibold text-info">
                        <i class="fas fa-level-up-alt me-2"></i>자산 업그레이드 관리
                    </h6>
                    <a href="{{ url_for('operations.upgrade_management') }}" class="btn btn-info btn-sm">
                        <i class="fas fa-list fa-sm"></i> 전체 보기
                    </a>
                </div>
            </div>
            <div class="card-body d-flex flex-column p-4">
                <p class="text-muted">자산의 업그레이드 계획, 진행, 완료 관리</p>
                <div class="list-group mb-3">
                    <a href="{{ url_for('operations.upgrade_management') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        업그레이드 현황 <i class="fas fa-chevron-right"></i>
                    </a>
                    <a href="{{ url_for('operations.upgrade_plan_detail', plan_id=1) }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        업그레이드 계획 <i class="fas fa-chevron-right"></i>
                    </a>
                </div>
                <div class="mt-auto text-center">
                    <a href="{{ url_for('operations.upgrade_management') }}" class="btn btn-outline-info">
                        <i class="fas fa-level-up-alt me-1"></i> 업그레이드 관리
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 자산 수명주기 관리 카드 -->
    <div class="col-lg-4 mb-4">
        <div class="card shadow-sm border-0 h-100">
            <div class="card-header bg-light border-bottom py-3">
                <div class="d-flex justify-content-between align-items-center">
                    <h6 class="mb-0 fw-semibold text-secondary">
                        <i class="fas fa-history me-2"></i>자산 수명주기 관리
                    </h6>
                    <a href="{{ url_for('operations.lifecycle_tracking') }}" class="btn btn-secondary btn-sm">
                        <i class="fas fa-list fa-sm"></i> 전체 보기
                    </a>
                </div>
            </div>
            <div class="card-body d-flex flex-column p-4">
                <p class="text-muted">자산의 전체 수명주기 추적 및 관리</p>
                <div class="list-group mb-3">
                    <a href="{{ url_for('operations.lifecycle_tracking') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        수명주기 추적 <i class="fas fa-chevron-right"></i>
                    </a>
                    <a href="{{ url_for('operations.asset_lifecycle_timeline') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        타임라인 보기 <i class="fas fa-chevron-right"></i>
                    </a>
                    <a href="{{ url_for('operations.history') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        이력 조회 <i class="fas fa-chevron-right"></i>
                    </a>
                </div>
                <div class="mt-auto text-center">
                    <a href="{{ url_for('operations.history') }}" class="btn btn-outline-secondary">
                        <i class="fas fa-history me-1"></i> 이력 조회
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 최근 활동 및 통계 -->
<div class="row mt-4">
    <div class="col-lg-8">
        <div class="card shadow-sm border-0">
            <div class="card-header bg-light border-bottom py-3">
                <div class="d-flex justify-content-between align-items-center">
                    <h6 class="mb-0 fw-semibold text-gray-800">
                        <i class="fas fa-clock me-2 text-primary"></i>최근 활동
                    </h6>
                    <a href="{{ url_for('operations.history') }}" class="btn btn-outline-primary btn-sm">
                        <i class="fas fa-list me-1"></i> 전체 보기
                    </a>
                </div>
            </div>
            <div class="card-body p-0">
                <div class="list-group list-group-flush">
                    <div class="list-group-item d-flex justify-content-between align-items-center">
                        <div class="d-flex align-items-center">
                            <div class="bg-primary rounded-circle me-3" style="width: 10px; height: 10px;"></div>
                            <div>
                                <span class="fw-medium">노트북 Dell XPS 13</span> 대여 신청
                                <small class="d-block text-muted">김철수 → IT팀</small>
                            </div>
                        </div>
                        <small class="text-muted">5분 전</small>
                    </div>
                    <div class="list-group-item d-flex justify-content-between align-items-center">
                        <div class="d-flex align-items-center">
                            <div class="bg-success rounded-circle me-3" style="width: 10px; height: 10px;"></div>
                            <div>
                                <span class="fw-medium">모니터 LG 27인치</span> 반납 완료
                                <small class="d-block text-muted">이영희 → 관리팀</small>
                            </div>
                        </div>
                        <small class="text-muted">15분 전</small>
                    </div>
                    <div class="list-group-item d-flex justify-content-between align-items-center">
                        <div class="d-flex align-items-center">
                            <div class="bg-warning rounded-circle me-3" style="width: 10px; height: 10px;"></div>
                            <div>
                                <span class="fw-medium">프린터 HP LaserJet</span> 지급 승인 대기
                                <small class="d-block text-muted">마케팅팀 → 경영지원팀</small>
                            </div>
                        </div>
                        <small class="text-muted">1시간 전</small>
                    </div>
                    <div class="list-group-item d-flex justify-content-between align-items-center">
                        <div class="d-flex align-items-center">
                            <div class="bg-danger rounded-circle me-3" style="width: 10px; height: 10px;"></div>
                            <div>
                                <span class="fw-medium">데스크탑 구형 PC</span> 폐기 신청
                                <small class="d-block text-muted">관리팀 → 폐기 담당</small>
                            </div>
                        </div>
                        <small class="text-muted">2시간 전</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-lg-4">
        <div class="card shadow-sm border-0">
            <div class="card-header bg-light border-bottom py-3">
                <h6 class="mb-0 fw-semibold text-gray-800">
                    <i class="fas fa-chart-bar me-2 text-primary"></i>운영 통계
                </h6>
            </div>
            <div class="card-body p-4">
                <div class="mb-3">
                    <div class="d-flex justify-content-between align-items-center mb-1">
                        <span class="text-muted small">이번 달 대여</span>
                        <span class="fw-bold">45건</span>
                    </div>
                    <div class="progress" style="height: 6px;">
                        <div class="progress-bar bg-primary" style="width: 75%"></div>
                    </div>
                </div>
                <div class="mb-3">
                    <div class="d-flex justify-content-between align-items-center mb-1">
                        <span class="text-muted small">반납률</span>
                        <span class="fw-bold">92%</span>
                    </div>
                    <div class="progress" style="height: 6px;">
                        <div class="progress-bar bg-success" style="width: 92%"></div>
                    </div>
                </div>
                <div class="mb-3">
                    <div class="d-flex justify-content-between align-items-center mb-1">
                        <span class="text-muted small">자산 활용도</span>
                        <span class="fw-bold">78%</span>
                    </div>
                    <div class="progress" style="height: 6px;">
                        <div class="progress-bar bg-info" style="width: 78%"></div>
                    </div>
                </div>
                <div class="text-center mt-3">
                    <a href="{{ url_for('operations.statistics') }}" class="btn btn-outline-primary btn-sm">
                        <i class="fas fa-chart-line me-1"></i> 상세 통계
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/shared/operations/operations-utils.js') }}"></script>
<script src="{{ url_for('static', filename='js/shared/operations/notification-utils.js') }}"></script>
<script src="{{ url_for('static', filename='js/shared/operations/api-utils.js') }}"></script>
<script src="{{ url_for('static', filename='js/pages/operations/index.js') }}"></script>
{% endblock %} 
